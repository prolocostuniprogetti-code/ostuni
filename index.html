<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ostuni Tour Guide</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.2/dist/tailwind.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
#map { height: 60vh; width: 100%; }
.leaflet-popup-content-wrapper { font-family: 'Inter', sans-serif; }
</style>
</head>
<body class="bg-gray-50 font-sans">

<header class="bg-blue-900 text-white p-4 text-center font-bold text-xl">Ostuni: La Città Bianca - Guida Interattiva</header>

<div id="map"></div>

<section class="max-w-4xl mx-auto mt-6 p-4 bg-white rounded shadow">
  <h2 class="text-xl font-semibold mb-4">Punti d'Interesse</h2>
  <div id="attractions-list" class="space-y-4"></div>
</section>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
const attrazioni = [
  {
    id: "cattedrale",
    nome: "Cattedrale di Santa Maria Assunta",
    descrizione: "Famosa per il suo maestoso rosone gotico a 24 raggi sulla sommità del colle.",
    lat: 40.7292,
    lng: 17.5947
  },
  {
    id: "arco",
    nome: "Arco Scoppa",
    descrizione: "Un elegante ponte in pietra che unisce il Palazzo Vescovile e il Seminario.",
    lat: 40.7268,
    lng: 17.5928
  },
  {
    id: "porta-blu",
    nome: "Casa con la Porta Blu",
    descrizione: "L'angolo più instagrammato della città, con la sua porta colorata che spicca sul bianco.",
    lat: 40.7285,
    lng: 17.5941
  },
  {
    id: "mura-aragonesi",
    nome: "Mura Aragonesi",
    descrizione: "Antiche fortificazioni che circondano il centro, offrendo panorami mozzafiato sulla piana degli ulivi.",
    lat: 40.7276,
    lng: 17.5960
  }
];

// Inizializza la mappa
const map = L.map('map').setView([40.7289, 17.5949], 15);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap contributors'
}).addTo(map);

// Funzione per creare popup personalizzati e aggiungere marker
attrazioni.forEach(a => {
  const marker = L.marker([a.lat, a.lng]).addTo(map);
  marker.bindPopup(`<strong>${a.nome}</strong><br>${a.descrizione}`);

  // Evento click sincronizzato con lista
  marker.on('click', () => {
    selectAttraction(a.id);
  });
});

// Genera lista interattiva attrazioni
const listDiv = document.getElementById('attractions-list');

function selectAttraction(id) {
  // Passa in evidenza elemento selezionato
  Array.from(listDiv.children).forEach(div => {
    div.classList.remove('bg-blue-100');
  });
  const selectedElem = document.getElementById('item-' + id);
  if (selectedElem) selectedElem.classList.add('bg-blue-100');

  // Zoom sulla mappa
  const attr = attrazioni.find(a => a.id === id);
  if (attr) {
    map.setView([attr.lat, attr.lng], 17, { animate: true });
    map.openPopup(L.marker([attr.lat, attr.lng]).getPopup());
  }
}

attrazioni.forEach(a => {
  const div = document.createElement('div');
  div.id = 'item-' + a.id;
  div.className = 'cursor-pointer p-4 border rounded hover:bg-blue-50';
  div.innerHTML = `<h3 class="font-semibold">${a.nome}</h3><p class="text-sm text-gray-700">${a.descrizione}</p>`;
  div.onclick = () => selectAttraction(a.id);
  listDiv.appendChild(div);
});
</script>
</body>
</html>
